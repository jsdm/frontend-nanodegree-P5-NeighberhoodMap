function searchViewModel(){var e=new google.maps.InfoWindow,n=this,a=[];n.iniList=ko.observableArray(nepalList),n.query=ko.observable(""),n.search=function(a){n.iniList([]);for(var t in nepalList)nepalList[t].name.toLowerCase().indexOf(a.toLowerCase())>=0&&n.iniList.push(nepalList[t]);n.putMarker(),e.close()},n.putMarker=function(){function t(e){var t,i=new google.maps.Marker({position:n.iniList()[e].latlng,map:map,title:n.iniList()[e].name});a.push(i),google.maps.event.addListener(i,"click",function(){n.openInfo(n.iniList()[e])})}for(var i=0;i<a.length;i++)a[i].setMap(null);a=[],n.openInfo=function(e){for(var t=0;t<a.length;t++)a[t].title===e.name?a[t].setAnimation(google.maps.Animation.BOUNCE):a[t].setAnimation(null);n.wikiReq(e,map)},n.wikiReq=function(n,a){var t="http://en.wikipedia.org/w/api.php?action=opensearch&search="+n.name+"&format=json&callback=wikiCallback",i=setTimeout(function(){e.setContent("Failed to get Wikipedia resources");var t=n.latlng.lng,i=n.latlng.lat+.0015,o={lat:i,lng:t};e.setPosition(o),e.open(a)},5e3);$.ajax({url:t,dataType:"jsonp",success:function(t){var o=t[1],l=t[2];""==l[0]&&(l[0]="No more info");var s='<div id="content"><div id="siteNotice"></div><h3 id="firstHeading" class="firstHeading">'+o[0]+'</h3><div id="bodyContent"><p>'+l[0]+"</p></div></div>";e.setContent(s);var r=n.latlng.lng,p=n.latlng.lat+.0015,g={lat:p,lng:r};e.setPosition(g),e.open(a),clearTimeout(i)}})};for(var o=0;o<n.iniList().length;o++)t(o)},n.query.subscribe(n.search),n.putMarker()}function initMap(){var e={center:center,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("googleMap"),e),ko.applyBindings(new searchViewModel)}var nepalList=[{name:"Children's Art Museum of Nepal",latlng:{lat:27.71114,lng:85.322141}},{name:"Narayanhity Palace",latlng:{lat:27.71501,lng:85.318097}},{name:"Royal Nepal Academy",latlng:{lat:27.708903,lng:85.320373}},{name:"Department of passport",latlng:{lat:27.71462,lng:85.316349}},{name:"Garden of Dreams",latlng:{lat:27.714464,lng:85.31448}}],map,center={lat:27.712039,lng:85.317721};
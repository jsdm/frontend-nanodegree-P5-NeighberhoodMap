function searchViewModel(){var e=new google.maps.InfoWindow,a=this,n=[];a.iniList=ko.observableArray(nepalList),a.query=ko.observable(""),a.search=function(n){a.iniList([]);for(var t in nepalList)nepalList[t].name.toLowerCase().indexOf(n.toLowerCase())>=0&&a.iniList.push(nepalList[t]);a.putMarker(),e.close()},a.putMarker=function(){function t(e){var t,i=new google.maps.Marker({position:a.iniList()[e].latlng,map:map,title:a.iniList()[e].name});n.push(i),google.maps.event.addListener(i,"click",function(){a.openInfo(a.iniList()[e])})}for(var i=0;i<n.length;i++)n[i].setMap(null);n=[],a.openInfo=function(e){for(var t=0;t<n.length;t++)n[t].title===e.name?n[t].setAnimation(google.maps.Animation.BOUNCE):n[t].setAnimation(null);a.wikiReq(e,map)},a.wikiReq=function(a,n){var t="http://en.wikipedia.org/w/api.php?action=opensearch&search="+a.name+"&format=json&callback=wikiCallback",i=setTimeout(function(){e.setContent("Failed to get Wikipedia resources")},5e3);$.ajax({url:t,dataType:"jsonp",success:function(t){var o=t[1],l=t[2],s='<div id="content"><div id="siteNotice"></div><h3 id="firstHeading" class="firstHeading">'+o[0]+'</h3><div id="bodyContent"><p>'+l[0]+"</p></div></div>";e.setContent(s);var r=a.latlng.lng,p=a.latlng.lat+.0015,c={lat:p,lng:r};e.setPosition(c),e.open(n),clearTimeout(i)}})};for(var o=0;o<a.iniList().length;o++)t(o)},a.query.subscribe(a.search),a.putMarker()}function initMap(){var e={center:center,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("googleMap"),e),ko.applyBindings(new searchViewModel)}var nepalList=[{name:"Children's Art Museum of Nepal",latlng:{lat:27.71114,lng:85.322141},description:"Creative space designed for children and youth",things:"Hotel"},{name:"Narayanhity Palace",latlng:{lat:27.71501,lng:85.318097},description:"The old royal palace where most of the royal family was murdered in 2002",things:"Museum"},{name:"Royal Nepal Academy",latlng:{lat:27.708903,lng:85.320373},description:"Formerly Royal Nepal Academy, now Nepal Academy",things:"School"},{name:"Department of passport",latlng:{lat:27.71462,lng:85.316349},description:"The department of passports where there's always a long line of people renewing their passports for overseas work",things:"Passports...?"},{name:"Garden of Dreams",latlng:{lat:27.714464,lng:85.31448},description:"A neo-classical garden",things:"Hotel"}],map,center={lat:27.712039,lng:85.317721};
function searchViewModel(){var e=new google.maps.InfoWindow,a=this;a.articleStr=ko.observable(),a.articleHead=ko.observable();var n=[];a.iniList=ko.observableArray(nepalList),a.query=ko.observable(""),a.search=function(n){a.iniList([]);for(var t in nepalList)nepalList[t].name.toLowerCase().indexOf(n.toLowerCase())>=0&&a.iniList.push(nepalList[t]);a.putMarker(),e.close()},a.putMarker=function(){function t(t){var i=new google.maps.Marker({position:a.iniList()[t].latlng,map:map,title:a.iniList()[t].name});n.push(i),google.maps.event.addListener(i,"click",function(){e.setContent(a.iniList()[t].description),e.open(map,i),a.wikiReq(a.iniList()[t])})}for(var i=0;i<n.length;i++)n[i].setMap(null);n=[],a.openInfo=function(n){e.setContent(n.description);var t=n.latlng.lng,i=n.latlng.lat+.0015,o={lat:i,lng:t};e.setPosition(o),e.open(map),a.wikiReq(n)},a.wikiReq=function(e){var n="http://en.wikipedia.org/w/api.php?action=opensearch&search="+e.name+"&format=json&callback=wikiCallback",t=setTimeout(function(){articleStr="Failed to get Wikipedia resources"},5e3);$.ajax({url:n,dataType:"jsonp",success:function(e){var n=e[1],i=e[2];a.articleHead(n[0]),a.articleStr(i[0]),clearTimeout(t)}})};for(var o=0;o<a.iniList().length;o++)t(o)},a.query.subscribe(a.search),a.putMarker()}function initMap(){var e={center:center,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("googleMap"),e),ko.applyBindings(new searchViewModel)}var nepalList=[{name:"Children's Art Museum of Nepal",latlng:{lat:27.71114,lng:85.322141},description:"Creative space designed for children and youth",things:"Hotel"},{name:"Narayanhity Palace",latlng:{lat:27.71501,lng:85.318097},description:"The old royal palace where most of the royal family was murdered in 2002",things:"Museum"},{name:"Royal Nepal Academy",latlng:{lat:27.708903,lng:85.320373},description:"Formerly Royal Nepal Academy, now Nepal Academy",things:"School"},{name:"Department of passport",latlng:{lat:27.71462,lng:85.316349},description:"The department of passports where there's always a long line of people renewing their passports for overseas work",things:"Passports...?"},{name:"Garden of Dreams",latlng:{lat:27.714464,lng:85.31448},description:"A neo-classical garden",things:"Hotel"}],map,center={lat:27.712039,lng:85.317721};
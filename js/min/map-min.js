function searchViewModel(){var e=new google.maps.InfoWindow,a=this,n=[];a.iniList=ko.observableArray(nepalList),a.query=ko.observable(""),a.search=function(n){a.iniList([]);for(var i in nepalList)nepalList[i].name.toLowerCase().indexOf(n.toLowerCase())>=0&&a.iniList.push(nepalList[i]);a.putMarker(),e.close()},a.putMarker=function(){function i(i){var t=new google.maps.Marker({position:a.iniList()[i].latlng,map:map,title:a.iniList()[i].name});n.push(t),google.maps.event.addListener(t,"click",function(){a.wikiReq(a.iniList()[i]),e.open(map,t)})}for(var t=0;t<n.length;t++)n[t].setMap(null);n=[],a.openInfo=function(n){a.wikiReq(n);var i=n.latlng.lng,t=n.latlng.lat+.0015,o={lat:t,lng:i};e.setPosition(o),e.open(map),a.wikiReq(n)},a.wikiReq=function(a){var n="http://en.wikipedia.org/w/api.php?action=opensearch&search="+a.name+"&format=json&callback=wikiCallback",i=setTimeout(function(){e.setContent("Failed to get Wikipedia resources")},5e3);$.ajax({url:n,dataType:"jsonp",success:function(a){var n=a[1],t=a[2],o='<div id="content"><div id="siteNotice"></div><h3 id="firstHeading" class="firstHeading">'+n[0]+'</h3><div id="bodyContent"><p>'+t[0]+"</p></div></div>";e.setContent(o),clearTimeout(i)}})};for(var o=0;o<a.iniList().length;o++)i(o)},a.query.subscribe(a.search),a.putMarker()}function initMap(){var e={center:center,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("googleMap"),e),ko.applyBindings(new searchViewModel)}var nepalList=[{name:"Children's Art Museum of Nepal",latlng:{lat:27.71114,lng:85.322141},description:"Creative space designed for children and youth",things:"Hotel"},{name:"Narayanhity Palace",latlng:{lat:27.71501,lng:85.318097},description:"The old royal palace where most of the royal family was murdered in 2002",things:"Museum"},{name:"Royal Nepal Academy",latlng:{lat:27.708903,lng:85.320373},description:"Formerly Royal Nepal Academy, now Nepal Academy",things:"School"},{name:"Department of passport",latlng:{lat:27.71462,lng:85.316349},description:"The department of passports where there's always a long line of people renewing their passports for overseas work",things:"Passports...?"},{name:"Garden of Dreams",latlng:{lat:27.714464,lng:85.31448},description:"A neo-classical garden",things:"Hotel"}],map,center={lat:27.712039,lng:85.317721};
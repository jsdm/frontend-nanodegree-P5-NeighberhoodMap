function searchViewModel(){var e=new google.maps.InfoWindow,n=this,a=[];n.iniList=ko.observableArray(nepalList),n.query=ko.observable(""),n.search=function(a){n.iniList([]);for(var i in nepalList)nepalList[i].name.toLowerCase().indexOf(a.toLowerCase())>=0&&n.iniList.push(nepalList[i]);n.putMarker(),e.close()},n.putMarker=function(){function i(e){var i=new google.maps.Marker({position:n.iniList()[e].latlng,map:map,title:n.iniList()[e].name});a.push(i),google.maps.event.addListener(i,"click",function(){n.markerBounce(i),n.wikiReq(n.iniList()[e])})}for(var t,o=0;o<a.length;o++)a[o].setMap(null);a=[],n.markerBounce=function(n){null!=t&&t.setAnimation(null),n.setAnimation(google.maps.Animation.BOUNCE),e.open(map,n),t=n},n.openInfo=function(i){for(var t=0;t<a.length;t++)a[t].title==i.name&&n.markerBounce(a[t]);n.wikiReq(i);var o=i.latlng.lng,l=i.latlng.lat+.0015,s={lat:l,lng:o};e.setPosition(s),e.open(map),n.wikiReq(i)},n.wikiReq=function(n){var a="http://en.wikipedia.org/w/api.php?action=opensearch&search="+n.name+"&format=json&callback=wikiCallback",i=setTimeout(function(){e.setContent("Failed to get Wikipedia resources")},5e3);$.ajax({url:a,dataType:"jsonp",success:function(n){var a=n[1],t=n[2],o='<div id="content"><div id="siteNotice"></div><h3 id="firstHeading" class="firstHeading">'+a[0]+'</h3><div id="bodyContent"><p>'+t[0]+"</p></div></div>";e.setContent(o),clearTimeout(i)}})};for(var l=0;l<n.iniList().length;l++)i(l)},n.query.subscribe(n.search),n.putMarker()}function initMap(){var e={center:center,zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("googleMap"),e),ko.applyBindings(new searchViewModel)}var nepalList=[{name:"Children's Art Museum of Nepal",latlng:{lat:27.71114,lng:85.322141},description:"Creative space designed for children and youth",things:"Hotel"},{name:"Narayanhity Palace",latlng:{lat:27.71501,lng:85.318097},description:"The old royal palace where most of the royal family was murdered in 2002",things:"Museum"},{name:"Royal Nepal Academy",latlng:{lat:27.708903,lng:85.320373},description:"Formerly Royal Nepal Academy, now Nepal Academy",things:"School"},{name:"Department of passport",latlng:{lat:27.71462,lng:85.316349},description:"The department of passports where there's always a long line of people renewing their passports for overseas work",things:"Passports...?"},{name:"Garden of Dreams",latlng:{lat:27.714464,lng:85.31448},description:"A neo-classical garden",things:"Hotel"}],map,center={lat:27.712039,lng:85.317721};
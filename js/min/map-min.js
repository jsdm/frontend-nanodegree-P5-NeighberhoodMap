function initMap(){var e={center:center,zoom:16,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("googleMap"),e),ko.applyBindings(new searchViewModel)}function searchViewModel(){var e=new google.maps.InfoWindow,a=this,n=[];a.iniList=ko.observableArray(nepalList),a.query=ko.observable(""),a.search=function(n){a.iniList([]);for(var i in nepalList)nepalList[i].name.toLowerCase().indexOf(n.toLowerCase())>=0&&a.iniList.push(nepalList[i]);a.putMarker(),e.close()},a.putMarker=function(){function i(i){var t=new google.maps.Marker({position:a.iniList()[i].latlng,map:map,title:a.iniList()[i].name,label:a.iniList()[i].label});n.push(t),google.maps.event.addListener(t,"click",function(){e.setContent(a.iniList()[i].description),e.open(map,t)})}for(var t=0;t<n.length;t++)n[t].setMap(null);$wikiElem.text(""),n=[],a.openInfo=function(n){e.setContent(n.description);var i=n.latlng.lng,t=n.latlng.lat+77e-5,l={lat:t,lng:i};e.setPosition(l),e.open(map),a.wikiReq(n)},a.wikiReq=function(e){$wikiElem.text("");var a="http://en.wikipedia.org/w/api.php?action=opensearch&search="+e.name+"&format=json&callback=wikiCallback",n=setTimeout(function(){$wikiElem.text("Failed to get Wikipedia resources")},5e3);$.ajax({url:a,dataType:"jsonp",success:function(e){for(var a,i,t=e[1],l=e[2],o=0;o<t.length;o++){a=t[o],i=l[o];var s="http://en.wikipedia.org/wiki/"+a;$wikiElem.append('<li><a href="'+s+'">'+a+"</a><p>"+l+"</p></li>")}clearTimeout(n)}})};for(var l=0;l<a.iniList().length;l++)i(l)},a.query.subscribe(a.search),a.putMarker()}var nepalList=[{name:"Children's Art Museum of Nepal",latlng:{lat:27.71114,lng:85.322141},description:"Creative space designed for children and youth",things:"Hotel",label:"A"},{name:"Narayanhity Palace",latlng:{lat:27.71501,lng:85.318097},description:"The old royal palace where most of the royal family was murdered in 2002",things:"Museum",label:"B"},{name:"Royal Nepal Academy",latlng:{lat:27.708903,lng:85.320373},description:"Formerly Royal Nepal Academy, now Nepal Academy",things:"School",label:"C"},{name:"Department of passport",latlng:{lat:27.71462,lng:85.316349},description:"The department of passports where there's always a long line of people renewing their passports for overseas work",things:"Passports...?",label:"D"},{name:"Garden of Dreams",latlng:{lat:27.714464,lng:85.31448},description:"A neo-classical garden",things:"Hotel",label:"E"}],map,center={lat:27.711292,lng:85.316355},$wikiElem=$("#wikiInfo");